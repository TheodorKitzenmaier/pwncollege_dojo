{% extends "base.html" %}


{% block stylesheets %}
{{ super() }}

<style>
    :root {
        --background: #111;
        --foreground: #222;
        --highlight: #6c757d;
        --correct: #008000;
    }

    html, body {
        margin: 0;
        height: 100%;
        min-height: 100%;
        background-color: var(--background);
        overflow: hidden;
    }

    body {
        display: flex;
        flex-direction: column;
    }

    nav, footer {
        flex: none;
    }

    main {
        flex: auto;
        margin: 0;
        display: flex;
        flex-direction: column;
    }

    #workspace-content {
        flex: 1;
        width: 100%;
        border: none;
    }

    #workspace-controls {
        width: 100%;
        height: 2.5em;
        margin: 5px 0;
        padding: 0 5px;
        display: flex;
        flex-wrap: nowrap;
    }

    .workspace-control {
        height: 100%;
        margin: 0 2px;
        border-width: 0px;
        border-radius: 1em;
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
        background-color: var(--foreground);
    }

    button.workspace-control {
        width: 2.5em;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .workspace-control input {
        height: 100% !important;
        box-sizing: border-box;
        padding: 1em;
        color: #fff;
        background-color: var(--foreground);
        border: 0;
        border-color: #000 !important;
        border-radius: 1em;
        box-shadow: none !important;
    }

    .workspace-control input::placeholder {
        color: var(--highlight);
        opacity: 1;
    }

    .workspace-control input:focus:not(.submit-correct):not(.submit-incorrect):not(.submit-warn),
    .workspace-control input:hover:not(.submit-correct):not(.submit-incorrect):not(.submit-warn) {
        outline: 0 !important;
    }

    .workspace-control select {
        height: 100%;
        border: 0;
        background-color: var(--foreground);
        color: var(--highlight);
        font-size: 16px;
        line-height: 20px;
        font-weight: 700;
    }

    .workspace-highlight {
        color: var(--highlight);
    }

    .workspace-input {
        padding-left: 1em;
    }

    .workspace-selector-body {
        padding-left: 1em;
        padding-right: 1em;
    }

    .submit-correct {
        outline: 2px solid var(--correct) !important;
    }

    .submit-incorrect {
        outline: 2px solid #800000 !important;
    }

    .submit-warn {
        outline: 2px solid #d0c000 !important;
    }

    .workspace-control-spacer {
        flex: 1;
    }

    @keyframes banner-animate {
        0% {
            bottom: -6em;
            left: 50%;
            width: 0%;
        }
        5% {
            bottom: 4em;
            left: 10%;
            width: 80%;
        }
        95% {
            bottom: 4em;
            left: 10%;
            width: 80%;
        }
        100% {
            bottom: -6em;
            left: 50%;
            width: 0%;
        }
    }

    .notif-animate {
        animation-name: banner-animate;
        animation-duration: 20s;
        animation-fill-mode: forwards;
        display: block !important;
    }

    #notif-banner {
        position: absolute;
        background-color: var(--foreground);
        color: var(--highlight);
        border-color: var(--correct);
        border-style: solid;
        border-width: 2px;
        border-radius: 1em;
        padding: 1em;
        height: 4em;
        text-align: center;
        font-weight: bold;
        overflow: hidden;
        display: none;
    }
</style>
{% endblock %}


{% block content %}
<iframe src="" id="workspace-content"></iframe>

<div id="workspace-controls">
    <div id="notif-banner"></div>
    <div title="Change workspace" class="workspace-selector-body workspace-control">
        <i class="fas fa-bars workspace-highlight"></i>
        <select id="workspace-select">
            {% for service in workspace_services %}
            <option value="{{ service | lower }}">{{ service }}</option>
            {% endfor %}
        </select>
    </div>
    <div title="Enter flag" class="workspace-control workspace-input">
        <i class="fas fa-flag workspace-highlight"></i>
        <input id="flag-input" class="" type="text" placeholder="Flag">
        <input type="hidden" id="current-challenge-id" value="{{ challenge.challenge_id }}">
    </div>
    <div class="workspace-control-spacer"></div>
    <button id="challenge-restart" title="Restart challenge" class="workspace-control btn btn-md btn-outline-secondary btn-challenge-start">
        <i class="fas fa-redo"></i>
    </button>
    {% if challenge.allow_privileged %}
    <button id="challenge-switch"
            title="Restart {{'unprivileged' if practice else 'privileged'}}"
            class="workspace-control btn btn-md btn-outline-secondary btn-challenge-start"
            data-privileged="{{'true' if practice else 'false'}}">
        <i class="fas fa-{{'unlock' if practice else 'lock'}}"></i>
    </button>
    {% endif %}
    <!-- Add some cool new UX features here! -->
    <button id="fullscreen" title="Toggle fullscreen" class="workspace-control btn btn-md btn-outline-secondary">
        <i class="fas fa-expand"></i>
    </button>
</div>

<div id="alert"></div>
{% endblock %}


{% block scripts %}
<script defer src="{{ url_for('views.themes', path='js/dojo/workspace.js') }}"></script>
{% endblock %}