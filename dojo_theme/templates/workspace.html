{% extends "base.html" %}


{% block stylesheets %}
{{ super() }}

<style>
    :root {
        --background: #111;
        --foreground: #222;
        --highlight: #6c757d;
        --error: #800000;
        --warn: #d0c000;
    }

    html, body {
        margin: 0;
        height: 100%;
        min-height: 100%;
        background-color: var(--background);
        overflow: hidden;
    }

    body {
        display: flex;
        flex-direction: column;
    }

    nav, footer {
        flex: none;
    }

    main {
        flex: auto;
        margin: 0;
        display: flex;
        flex-direction: column;
    }

    #workspace-content {
        flex: 1;
        width: 100%;
        border: none;
    }

    #workspace-controls {
        width: 100%;
        height: 2.5em;
        margin: 5px 0;
        padding: 0 5px;
        display: flex;
        flex-wrap: nowrap;
    }

    .workspace-control {
        height: 100%;
        margin: 0 2px;
        border-width: 0px;
        border-radius: 1em;
        background-color: var(--foreground);
    }

    button.workspace-control {
        width: 2.5em;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .workspace-control input {
        height: 100% !important;
        box-sizing: border-box;
        padding-left: 0.5em;
        padding-right: 1em;
        color: #fff;
        background-color: var(--foreground);
        border: 0;
        border-color: #000 !important;
        border-radius: 1em;
        box-shadow: none !important;
    }

    .workspace-control input::placeholder {
        color: var(--highlight);
        opacity: 1;
    }

    .workspace-control select,
    .workspace-control input:focus,
    .workspace-control input:hover {
        outline: 0 !important;
    }

    .workspace-control select {
        height: 100%;
        padding-left: 0.5em;
        border: 0;
        background-color: var(--foreground);
        color: var(--highlight);
        font-weight: 700;
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
    }

    .workspace-highlight {
        color: var(--highlight);
    }

    .workspace-input {
        padding-left: 1em;
    }

    .workspace-selector-body {
        padding-left: 1em;
        padding-right: 1em;
    }

    .workspace-control-spacer {
        flex: 1;
    }

    @keyframes banner-animation {
        0% {
            bottom: -6em;
            left: 50%;
            width: 0%;
        }
        5% {
            bottom: 4em;
            left: 10%;
            width: 80%;
        }
        95% {
            bottom: 4em;
            left: 10%;
            width: 80%;
        }
        100% {
            bottom: -6em;
            left: 50%;
            width: 0%;
        }
    }

    .animate-banner {
        animation-name: banner-animation;
        animation-duration: 20s;
        animation-fill-mode: forwards;
        display: block !important;
    }

    .animate-banner-fast {
        animation-name: banner-animation;
        animation-duration: 5s;
        animation-fill-mode: forwards;
        display: block !important;
    }

    #workspace-notification-banner {
        position: absolute;
        background-color: var(--foreground);
        color: #fff;
        border-color: var(--brand-green);
        border-style: solid;
        border-width: 2px;
        border-radius: 1em;
        padding: 1em;
        height: 4em;
        text-align: center;
        overflow: hidden;
        display: none;
    }

    #ssh-hint {
        font-size: 2em;
        padding: .25em;
        height: 2em;
    }

    .ref {
        color: var(--brand-green);
        font-weight: bold;
    }

    #settings {
        position: absolute;
        border-top-left-radius: 1em;
        border-left: .5em solid;
        border-top: .5em solid;
        background-color: var(--foreground);
        border-color: var(--background);
        flex-direction: column;
        right: 0;
        bottom: calc(2.5em + 10px);
        padding: 1em;
        color: var(--highlight);
        display: none;
    }
</style>
{% endblock %}


{% block content %}
<iframe src="" id="workspace-content"></iframe>

<div id="ssh-hint">Configure your SSH keys in the <a class="ref" target="_blank" href="/settings#ssh-key">settings page</a>.</div>

<div id="workspace-controls">
    <div id="workspace-notification-banner"></div>
    <div title="Change workspace" class="workspace-selector-body workspace-control">
        <i class="fas fa-bars workspace-highlight"></i>
        <select id="workspace-select">
            {% for service in workspace_services %}
            <option value="{{ service | lower }}">{{ service }}</option>
            {% endfor %}
        </select>
    </div>
    <div title="Enter flag" class="workspace-control workspace-input">
        <i class="fas fa-flag workspace-highlight"></i>
        <input id="flag-input" class="" type="text" placeholder="Flag">
        <input type="hidden" id="current-challenge-id" value="{{ challenge.challenge_id }}" data-challenge-name="{{ challenge.name }}">
    </div>
    <div class="workspace-control-spacer"></div>
    <button id="challenge-restart" title="Restart challenge" class="workspace-control btn btn-md btn-outline-secondary btn-challenge-start">
        <i class="fas fa-redo"></i>
    </button>
    {% if challenge.allow_privileged %}
    <button id="workspace-change-privilege"
            title="Restart {{'unprivileged' if practice else 'privileged'}}"
            class="workspace-control btn btn-md btn-outline-secondary btn-challenge-start"
            data-privileged="{{'true' if practice else 'false'}}">
        <i class="fas fa-{{'unlock' if practice else 'lock'}}"></i>
    </button>
    {% endif %}
    <div id="settings">
        <div>Setting number one.</div>
        <div>Small</div>
        <div>Another cool setting!</div>
    </div>
    <button id="show-menu" title="Additional workspace settings" class="workspace-control btn btn-md btn-outline-secondary">
        <i class="fas fa-wrench"></i>
    </button>
    <button id="fullscreen" title="Toggle fullscreen" class="workspace-control btn btn-md btn-outline-secondary">
        <i class="fas fa-expand"></i>
    </button>
</div>

<div id="alert"></div>
{% endblock %}


{% block scripts %}
<script defer src="{{ url_for('views.themes', path='js/dojo/workspace.js') }}"></script>
{% endblock %}